---
title: "Example: no main effects"
output: html_document
---
```{r libraries, include=F}
library(tidyverse)
library(pcalg)
library(Rgraphviz)
```
This example shows an SCM with three features, no main effects, and a single interaction effect.

```{r scm}
set.seed(42)
n <- 1000
data <- tibble(
  A = rnorm(n),
  B = rnorm(n),
  Y = 2 * A * B + rnorm(n)
)
```
From the SCM we know that $A \to Y$ and $B \to Y$, however the DAG generated by the PC algorithm does not show this.
```{r}
pc(list(C = cor(data), n = nrow(data)),
   indepTest = gaussCItest,
   labels = colnames(data),
   alpha = 0.01) %>%
  plot
```
By default, the PC algorithm uses Pearson correlation coefficient(PCC) to test for dependency.
In the three figures below we can see that $A$, $B$ and $Y$ are marginally independent using PCC.
```{r correlations}
data %>%
  ggplot(aes(x = A, y = Y)) +
  geom_point() +
  geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
  ggtitle('Y ~ A')

data %>%
  ggplot(aes(x = B, y = Y)) +
  geom_point() +
  geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
  ggtitle('Y ~ B')

data %>%
  ggplot(aes(x = A, y = B)) +
  geom_point() +
  geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
  ggtitle('A ~ B')
```
The PC algorithm creates a skeleton by removing any edges between nodes which features are marginally or conditionally independent of each other.
Because all features are independent of each other at the marginal level, this results in an empty DAG with 3 vertices.

However, there are some clues that other measures could be used to check for dependency.
The bow-tie shape of the residuals of the first two figures show us that $A$ ⫫̷ $Y$ and $B$ ⫫̷ $Y$.
The third figure shows that $A$ and $B$ are not correlated.

Stratification can also be used to show dependence.
In the following figure $A$ and $Y$ are stratified by $B$.
```{r statified}
data %>%
  ggplot(aes(x = A, y = Y, color = B > 0)) +
  geom_point() +
  geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
  ggtitle('Y ~ A by B')
```

