Example: no main effects
================
Dzjon Hessing

This example shows an SCM with three features, no main effects, and a
single interaction effect.

``` r
set.seed(42)
n <- 1000
data <- tibble(
  A = rnorm(n),
  B = rnorm(n),
  Y = 2*A*B + rnorm(n)
)
```

From the SCM we know that \(A\) and \(B\) cause \(Y\), however the DAG
generated by the PC algorithm does not show this.

By default, the PC algorithm uses Pearson correlation coefficient(PCC)
to test for dependency. In the first three figures we can see that
\(A\), \(B\) and \(Y\) are marginally independent using PCC.

``` r
data %>%
  ggplot(aes(x = A, y = Y)) +
  geom_point() +
  geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
  ggtitle('Y ~ A')
```

![](/Users/dzjon/Projects/Thesis/examples/01-no_main_effects_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

``` r
data %>%
  ggplot(aes(x = B, y = Y)) +
  geom_point() +
  geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
  ggtitle('Y ~ B')
```

![](/Users/dzjon/Projects/Thesis/examples/01-no_main_effects_files/figure-gfm/unnamed-chunk-3-2.png)<!-- -->

``` r
data %>%
  ggplot(aes(x = A, y = B)) +
  geom_point() +
  geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
  ggtitle('A ~ B')
```

![](/Users/dzjon/Projects/Thesis/examples/01-no_main_effects_files/figure-gfm/unnamed-chunk-3-3.png)<!-- -->
The PC algorithm creates a skeleton by removing any edges between nodes
which features are marginally or conditionally independent of each
other. Because all features are independent of each other at the
marginal level, this results in an empty DAG with 3 vertices.

``` r
pc(list(C = cor(data), n = nrow(data)),
   indepTest = gaussCItest,
   labels = colnames(data),
   alpha = 0.01,
   verbose = T) %>%
  plot
```

    ## Order=0; remaining edges:6
    ## x= 1  y= 2  S=  : pval = 0.7526152 
    ## x= 1  y= 3  S=  : pval = 0.934281 
    ## x= 2  y= 3  S=  : pval = 0.07253972

![](/Users/dzjon/Projects/Thesis/examples/01-no_main_effects_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

``` r
# 1=A 2=B 3=Y
```

However, there are some clues that other measures could be used to check
for dependency. The bow-tie shape of the residuals of the first two
figures show us that \(A\) ⫫̷ \(Y\) and \(B\) ⫫̷ \(Y\). The third figure
shows that \(A\) ⫫ \(B\) because the residuals are not correlated.

Stratification can also be used to show dependence. In the following
figure \(A\) and \(Y\) are stratified by \(B\).

``` r
data %>%
  ggplot(aes(x = A, y = Y, color = B > 0)) +
  geom_point() +
  geom_smooth(method = 'lm', formula = y ~ x, se = FALSE) +
  ggtitle('Y ~ A by B')
```

![](/Users/dzjon/Projects/Thesis/examples/01-no_main_effects_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->
